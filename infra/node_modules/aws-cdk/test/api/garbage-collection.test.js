"use strict";
/* eslint-disable import/order */
Object.defineProperty(exports, "__esModule", { value: true });
const mockGarbageCollect = jest.fn();
const api_1 = require("../../lib/api");
const stack_refresh_1 = require("../../lib/api/garbage-collection/stack-refresh");
const mock_sdk_1 = require("../util/mock-sdk");
let garbageCollector;
let mockListStacks;
let mockDescribeStacks;
let mockGetTemplateSummary;
let mockGetTemplate;
let mockListObjectsV2;
let mockGetObjectTagging;
let mockDeleteObjects;
let mockDeleteObjectTagging;
let mockPutObjectTagging;
let stderrMock;
let sdk;
const ISOLATED_TAG = 'aws-cdk:isolated';
const DAY = 24 * 60 * 60 * 1000; // Number of milliseconds in a day
function mockTheToolkitInfo(stackProps) {
    const mockSdk = new mock_sdk_1.MockSdk();
    api_1.ToolkitInfo.lookup = jest.fn().mockResolvedValue(api_1.ToolkitInfo.fromStack((0, mock_sdk_1.mockBootstrapStack)(mockSdk, stackProps)));
}
function gc(props) {
    return new api_1.GarbageCollector({
        sdkProvider: sdk,
        action: props.action,
        resolvedEnvironment: {
            account: '123456789012',
            region: 'us-east-1',
            name: 'mock',
        },
        bootstrapStackName: 'GarbageStack',
        rollbackBufferDays: props.rollbackBufferDays ?? 0,
        createdBufferDays: props.createdAtBufferDays ?? 0,
        type: props.type,
        maxWaitTime: props.maxWaitTime,
        confirm: false,
    });
}
beforeEach(() => {
    sdk = new mock_sdk_1.MockSdkProvider({ realSdk: false });
    // By default, we'll return a non-found toolkit info
    api_1.ToolkitInfo.lookup = jest.fn().mockResolvedValue(api_1.ToolkitInfo.bootstrapStackNotFoundInfo('GarbageStack'));
    stderrMock = jest.spyOn(process.stderr, 'write').mockImplementation(() => { return true; });
});
afterEach(() => {
    stderrMock.mockRestore();
});
describe('Garbage Collection', () => {
    beforeEach(() => {
        mockListStacks = jest.fn().mockResolvedValue({
            StackSummaries: [
                { StackName: 'Stack1', StackStatus: 'CREATE_COMPLETE' },
                { StackName: 'Stack2', StackStatus: 'UPDATE_COMPLETE' },
            ],
        });
        mockGetTemplateSummary = jest.fn().mockReturnValue({
            Parameters: [{
                    ParameterKey: 'BootstrapVersion',
                    DefaultValue: '/cdk-bootstrap/abcde/version',
                }],
        });
        mockGetTemplate = jest.fn().mockReturnValue({
            TemplateBody: 'abcde',
        });
        mockListObjectsV2 = jest.fn().mockImplementation(() => {
            return Promise.resolve({
                Contents: [
                    { Key: 'asset1', LastModified: new Date(Date.now() - (2 * DAY)) },
                    { Key: 'asset2', LastModified: new Date(Date.now() - (10 * DAY)) },
                    { Key: 'asset3', LastModified: new Date(Date.now() - (100 * DAY)) },
                ],
                KeyCount: 3,
            });
        });
        mockGetObjectTagging = jest.fn().mockImplementation((params) => {
            return Promise.resolve({
                TagSet: params.Key === 'asset2' ? [{ Key: ISOLATED_TAG, Value: new Date().toISOString() }] : [],
            });
        });
        mockPutObjectTagging = jest.fn();
        mockDeleteObjects = jest.fn();
        mockDeleteObjectTagging = jest.fn();
        mockDescribeStacks = jest.fn();
        sdk.stubCloudFormation({
            listStacks: mockListStacks,
            getTemplateSummary: mockGetTemplateSummary,
            getTemplate: mockGetTemplate,
            describeStacks: mockDescribeStacks,
        });
        sdk.stubS3({
            listObjectsV2: mockListObjectsV2,
            getObjectTagging: mockGetObjectTagging,
            deleteObjects: mockDeleteObjects,
            deleteObjectTagging: mockDeleteObjectTagging,
            putObjectTagging: mockPutObjectTagging,
        });
    });
    afterEach(() => {
        mockGarbageCollect.mockClear();
    });
    test('rollbackBufferDays = 0 -- assets to be deleted', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 0,
            action: 'full',
        });
        await garbageCollector.garbageCollect();
        expect(mockListStacks).toHaveBeenCalledTimes(1);
        expect(mockListObjectsV2).toHaveBeenCalledTimes(2);
        // no tagging
        expect(mockGetObjectTagging).toHaveBeenCalledTimes(0);
        expect(mockPutObjectTagging).toHaveBeenCalledTimes(0);
        // assets are to be deleted
        expect(mockDeleteObjects).toHaveBeenCalledWith({
            Bucket: 'BUCKET_NAME',
            Delete: {
                Objects: [
                    { Key: 'asset1' },
                    { Key: 'asset2' },
                    { Key: 'asset3' },
                ],
                Quiet: true,
            },
        });
    });
    test('rollbackBufferDays > 0 -- assets to be tagged', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 3,
            action: 'full',
        });
        await garbageCollector.garbageCollect();
        expect(mockListStacks).toHaveBeenCalledTimes(1);
        expect(mockListObjectsV2).toHaveBeenCalledTimes(2);
        // assets tagged
        expect(mockGetObjectTagging).toHaveBeenCalledTimes(3);
        expect(mockPutObjectTagging).toHaveBeenCalledTimes(2); // one asset already has the tag
        // no deleting
        expect(mockDeleteObjects).toHaveBeenCalledTimes(0);
    });
    test('type = ecr -- throws error', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        expect(() => garbageCollector = gc({
            type: 'ecr',
            rollbackBufferDays: 3,
            action: 'full',
        })).toThrow(/ECR garbage collection is not yet supported/);
    });
    test('createdAtBufferDays > 0 -- assets to be tagged', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 0,
            createdAtBufferDays: 5,
            action: 'full',
        });
        await garbageCollector.garbageCollect();
        expect(mockDeleteObjects).toHaveBeenCalledWith({
            Bucket: 'BUCKET_NAME',
            Delete: {
                Objects: [
                    { Key: 'asset2' },
                    { Key: 'asset3' },
                ],
                Quiet: true,
            },
        });
    });
    test('action = print -- does not tag or delete', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        garbageCollector = garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 3,
            action: 'print',
        });
        await garbageCollector.garbageCollect();
        expect(mockListStacks).toHaveBeenCalledTimes(1);
        expect(mockListObjectsV2).toHaveBeenCalledTimes(2);
        // get tags, but dont put tags
        expect(mockGetObjectTagging).toHaveBeenCalledTimes(3);
        expect(mockPutObjectTagging).toHaveBeenCalledTimes(0);
        // no deleting
        expect(mockDeleteObjects).toHaveBeenCalledTimes(0);
    });
    test('action = tag -- does not delete', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        garbageCollector = garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 3,
            action: 'tag',
        });
        await garbageCollector.garbageCollect();
        expect(mockListStacks).toHaveBeenCalledTimes(1);
        expect(mockListObjectsV2).toHaveBeenCalledTimes(2);
        // tags objects
        expect(mockGetObjectTagging).toHaveBeenCalledTimes(3);
        expect(mockPutObjectTagging).toHaveBeenCalledTimes(2); // one object already has the tag
        // no deleting
        expect(mockDeleteObjects).toHaveBeenCalledTimes(0);
    });
    test('action = delete-tagged -- does not tag', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        garbageCollector = garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 3,
            action: 'delete-tagged',
        });
        await garbageCollector.garbageCollect();
        expect(mockListStacks).toHaveBeenCalledTimes(1);
        expect(mockListObjectsV2).toHaveBeenCalledTimes(2);
        // get tags, but dont put tags
        expect(mockGetObjectTagging).toHaveBeenCalledTimes(3);
        expect(mockPutObjectTagging).toHaveBeenCalledTimes(0);
    });
    test('ignore objects that are modified after gc start', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        const mockListObjectsV2Future = jest.fn().mockImplementation(() => {
            return Promise.resolve({
                Contents: [
                    { Key: 'asset1', LastModified: new Date(0) },
                    { Key: 'asset2', LastModified: new Date(0) },
                    { Key: 'asset3', LastModified: new Date(new Date().setFullYear(new Date().getFullYear() + 1)) }, // future date ignored everywhere
                ],
                KeyCount: 3,
            });
        });
        sdk.stubS3({
            listObjectsV2: mockListObjectsV2Future,
            getObjectTagging: mockGetObjectTagging,
            deleteObjects: mockDeleteObjects,
            putObjectTagging: mockPutObjectTagging,
        });
        garbageCollector = garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 0,
            action: 'full',
        });
        await garbageCollector.garbageCollect();
        // assets are to be deleted
        expect(mockDeleteObjects).toHaveBeenCalledWith({
            Bucket: 'BUCKET_NAME',
            Delete: {
                Objects: [
                    { Key: 'asset1' },
                    { Key: 'asset2' },
                    // no asset3
                ],
                Quiet: true,
            },
        });
    });
    test('bootstrap filters out other bootstrap versions', async () => {
        mockTheToolkitInfo({
            Parameters: [{
                    ParameterKey: 'Qualifier',
                    ParameterValue: 'zzzzzz',
                }],
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        garbageCollector = garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 3,
            action: 'full',
        });
        await garbageCollector.garbageCollect();
        expect(mockGetTemplateSummary).toHaveBeenCalledTimes(2);
        expect(mockGetTemplate).toHaveBeenCalledTimes(0);
    });
    test('parameter hashes are included', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        const mockGetTemplateSummaryAssets = jest.fn().mockReturnValue({
            Parameters: [{
                    ParameterKey: 'AssetParametersasset1',
                    DefaultValue: 'asset1',
                }],
        });
        sdk.stubCloudFormation({
            listStacks: mockListStacks,
            getTemplateSummary: mockGetTemplateSummaryAssets,
            getTemplate: mockGetTemplate,
        });
        garbageCollector = garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 0,
            action: 'full',
        });
        await garbageCollector.garbageCollect();
        expect(mockListStacks).toHaveBeenCalledTimes(1);
        expect(mockListObjectsV2).toHaveBeenCalledTimes(2);
        // no tagging
        expect(mockGetObjectTagging).toHaveBeenCalledTimes(0);
        expect(mockPutObjectTagging).toHaveBeenCalledTimes(0);
        // assets are to be deleted
        expect(mockDeleteObjects).toHaveBeenCalledWith({
            Bucket: 'BUCKET_NAME',
            Delete: {
                Objects: [
                    // no 'asset1'
                    { Key: 'asset2' },
                    { Key: 'asset3' },
                ],
                Quiet: true,
            },
        });
    });
    test('stackStatus in REVIEW_IN_PROGRESS means we wait until it changes', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        // Mock the listStacks call
        const mockListStacksStatus = jest.fn()
            .mockResolvedValueOnce({
            StackSummaries: [
                { StackName: 'Stack1', StackStatus: 'REVIEW_IN_PROGRESS' },
                { StackName: 'Stack2', StackStatus: 'UPDATE_COMPLETE' },
            ],
        })
            .mockResolvedValueOnce({
            StackSummaries: [
                { StackName: 'Stack1', StackStatus: 'UPDATE_COMPLETE' },
                { StackName: 'Stack2', StackStatus: 'UPDATE_COMPLETE' },
            ],
        });
        sdk.stubCloudFormation({
            listStacks: mockListStacksStatus,
            getTemplateSummary: mockGetTemplateSummary,
            getTemplate: mockGetTemplate,
        });
        garbageCollector = garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 3,
            action: 'full',
        });
        await garbageCollector.garbageCollect();
        // list are called as expected
        expect(mockListStacksStatus).toHaveBeenCalledTimes(2);
        // everything else runs as expected:
        // assets tagged
        expect(mockGetObjectTagging).toHaveBeenCalledTimes(3);
        expect(mockPutObjectTagging).toHaveBeenCalledTimes(2); // one object already has the tag
        // no deleting
        expect(mockDeleteObjects).toHaveBeenCalledTimes(0);
    }, 60000);
    test('fails when stackStatus stuck in REVIEW_IN_PROGRESS', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        // Mock the listStacks call
        const mockListStacksStatus = jest.fn()
            .mockResolvedValue({
            StackSummaries: [
                { StackName: 'Stack1', StackStatus: 'REVIEW_IN_PROGRESS' },
                { StackName: 'Stack2', StackStatus: 'UPDATE_COMPLETE' },
            ],
        });
        sdk.stubCloudFormation({
            listStacks: mockListStacksStatus,
            getTemplateSummary: mockGetTemplateSummary,
            getTemplate: mockGetTemplate,
        });
        garbageCollector = garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 3,
            action: 'full',
            maxWaitTime: 600, // Wait only 600 ms in tests
        });
        await expect(garbageCollector.garbageCollect()).rejects.toThrow(/Stacks still in REVIEW_IN_PROGRESS state after waiting/);
    }, 60000);
});
let mockListObjectsV2Large;
let mockGetObjectTaggingLarge;
describe('Garbage Collection with large # of objects', () => {
    const keyCount = 10000;
    beforeEach(() => {
        mockListStacks = jest.fn().mockResolvedValue({
            StackSummaries: [
                { StackName: 'Stack1', StackStatus: 'CREATE_COMPLETE' },
            ],
        });
        mockGetTemplateSummary = jest.fn().mockReturnValue({
            Parameters: [{
                    ParameterKey: 'BootstrapVersion',
                    DefaultValue: '/cdk-bootstrap/abcde/version',
                }],
        });
        // add every 5th asset hash to the mock template body: 8000 assets are isolated
        const mockTemplateBody = [];
        for (let i = 0; i < keyCount; i += 5) {
            mockTemplateBody.push(`asset${i}hash`);
        }
        mockGetTemplate = jest.fn().mockReturnValue({
            TemplateBody: mockTemplateBody.join('-'),
        });
        const contents = [];
        for (let i = 0; i < keyCount; i++) {
            contents.push({
                Key: `asset${i}hash`,
                LastModified: new Date(0),
            });
        }
        mockListObjectsV2Large = jest.fn().mockImplementation(() => {
            return Promise.resolve({
                Contents: contents,
                KeyCount: keyCount,
            });
        });
        // every other object has the isolated tag: of the 8000 isolated assets, 4000 already are tagged.
        // of the 2000 in use assets, 1000 are tagged.
        mockGetObjectTaggingLarge = jest.fn().mockImplementation((params) => {
            return Promise.resolve({
                TagSet: Number(params.Key[params.Key.length - 5]) % 2 === 0 ? [{ Key: ISOLATED_TAG, Value: new Date(2000, 1, 1).toISOString() }] : [],
            });
        });
        mockPutObjectTagging = jest.fn();
        mockDeleteObjects = jest.fn();
        mockDeleteObjectTagging = jest.fn();
        mockDescribeStacks = jest.fn();
        sdk.stubCloudFormation({
            listStacks: mockListStacks,
            getTemplateSummary: mockGetTemplateSummary,
            getTemplate: mockGetTemplate,
            describeStacks: mockDescribeStacks,
        });
        sdk.stubS3({
            listObjectsV2: mockListObjectsV2Large,
            getObjectTagging: mockGetObjectTaggingLarge,
            deleteObjects: mockDeleteObjects,
            deleteObjectTagging: mockDeleteObjectTagging,
            putObjectTagging: mockPutObjectTagging,
        });
    });
    afterEach(() => {
        mockGarbageCollect.mockClear();
    });
    test('tag only', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        garbageCollector = garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 1,
            action: 'tag',
        });
        await garbageCollector.garbageCollect();
        expect(mockListStacks).toHaveBeenCalledTimes(1);
        expect(mockListObjectsV2Large).toHaveBeenCalledTimes(2);
        // tagging is performed
        expect(mockGetObjectTaggingLarge).toHaveBeenCalledTimes(keyCount);
        expect(mockDeleteObjectTagging).toHaveBeenCalledTimes(1000); // 1000 in use assets are erroneously tagged
        expect(mockPutObjectTagging).toHaveBeenCalledTimes(5000); // 8000-4000 assets need to be tagged, + 1000 (since untag also calls this)
    });
    test('delete-tagged only', async () => {
        mockTheToolkitInfo({
            Outputs: [
                {
                    OutputKey: 'BootstrapVersion',
                    OutputValue: '999',
                },
            ],
        });
        garbageCollector = garbageCollector = gc({
            type: 's3',
            rollbackBufferDays: 1,
            action: 'delete-tagged',
        });
        await garbageCollector.garbageCollect();
        expect(mockListStacks).toHaveBeenCalledTimes(1);
        expect(mockListObjectsV2Large).toHaveBeenCalledTimes(2);
        // delete previously tagged objects
        expect(mockGetObjectTaggingLarge).toHaveBeenCalledTimes(keyCount);
        expect(mockDeleteObjects).toHaveBeenCalledTimes(4); // 4000 isolated assets are already tagged, deleted in batches of 1000
    });
});
describe('BackgroundStackRefresh', () => {
    let backgroundRefresh;
    let refreshProps;
    let setTimeoutSpy;
    beforeEach(() => {
        jest.useFakeTimers();
        setTimeoutSpy = jest.spyOn(global, 'setTimeout');
        mockListStacks = jest.fn().mockResolvedValue({
            StackSummaries: [
                { StackName: 'Stack1', StackStatus: 'CREATE_COMPLETE' },
                { StackName: 'Stack2', StackStatus: 'UPDATE_COMPLETE' },
            ],
        });
        mockGetTemplateSummary = jest.fn().mockReturnValue({
            Parameters: [{
                    ParameterKey: 'BootstrapVersion',
                    DefaultValue: '/cdk-bootstrap/abcde/version',
                }],
        });
        mockGetTemplate = jest.fn().mockReturnValue({
            TemplateBody: 'abcde',
        });
        sdk.stubCloudFormation({
            listStacks: mockListStacks,
            getTemplateSummary: mockGetTemplateSummary,
            getTemplate: mockGetTemplate,
            describeStacks: jest.fn(),
        });
        refreshProps = {
            cfn: sdk.mockSdk.cloudFormation(),
            activeAssets: new stack_refresh_1.ActiveAssetCache(),
            maxWaitTime: 60000, // 1 minute
        };
        backgroundRefresh = new stack_refresh_1.BackgroundStackRefresh(refreshProps);
    });
    afterEach(() => {
        jest.clearAllTimers();
        setTimeoutSpy.mockRestore();
    });
    test('should start after a delay', () => {
        void backgroundRefresh.start();
        expect(setTimeoutSpy).toHaveBeenCalledTimes(1);
        expect(setTimeoutSpy).toHaveBeenLastCalledWith(expect.any(Function), 300000);
    });
    test('should refresh stacks and schedule next refresh', async () => {
        void backgroundRefresh.start();
        // Run the first timer (which should trigger the first refresh)
        await jest.runOnlyPendingTimersAsync();
        expect(mockListStacks).toHaveBeenCalledTimes(1);
        expect(setTimeoutSpy).toHaveBeenCalledTimes(2); // Once for start, once for next refresh
        expect(setTimeoutSpy).toHaveBeenLastCalledWith(expect.any(Function), 300000);
        // Run the first timer (which triggers the first refresh)
        await jest.runOnlyPendingTimersAsync();
        expect(mockListStacks).toHaveBeenCalledTimes(2);
        expect(setTimeoutSpy).toHaveBeenCalledTimes(3); // Two refreshes plus one more scheduled
    });
    test('should wait for the next refresh if called within time frame', async () => {
        void backgroundRefresh.start();
        // Run the first timer (which triggers the first refresh)
        await jest.runOnlyPendingTimersAsync();
        const waitPromise = backgroundRefresh.noOlderThan(180000); // 3 minutes
        jest.advanceTimersByTime(120000); // Advance time by 2 minutes
        await expect(waitPromise).resolves.toBeUndefined();
    });
    test('should wait for the next refresh if refresh lands before the timeout', async () => {
        void backgroundRefresh.start();
        // Run the first timer (which triggers the first refresh)
        await jest.runOnlyPendingTimersAsync();
        jest.advanceTimersByTime(24000); // Advance time by 4 minutes
        const waitPromise = backgroundRefresh.noOlderThan(300000); // 5 minutes
        jest.advanceTimersByTime(120000); // Advance time by 2 minutes, refresh should fire
        await expect(waitPromise).resolves.toBeUndefined();
    });
    test('should reject if the refresh takes too long', async () => {
        void backgroundRefresh.start();
        // Run the first timer (which triggers the first refresh)
        await jest.runOnlyPendingTimersAsync();
        jest.advanceTimersByTime(120000); // Advance time by 2 minutes
        const waitPromise = backgroundRefresh.noOlderThan(0); // 0 seconds
        jest.advanceTimersByTime(120000); // Advance time by 2 minutes
        await expect(waitPromise).rejects.toThrow('refreshStacks took too long; the background thread likely threw an error');
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2FyYmFnZS1jb2xsZWN0aW9uLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJnYXJiYWdlLWNvbGxlY3Rpb24udGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsaUNBQWlDOztBQUVqQyxNQUFNLGtCQUFrQixHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztBQUVyQyx1Q0FBOEQ7QUFDOUQsa0ZBQXVJO0FBQ3ZJLCtDQUFnRjtBQUVoRixJQUFJLGdCQUFrQyxDQUFDO0FBQ3ZDLElBQUksY0FBK0csQ0FBQztBQUNwSCxJQUFJLGtCQUEySCxDQUFDO0FBQ2hJLElBQUksc0JBQXVJLENBQUM7QUFDNUksSUFBSSxlQUFrSCxDQUFDO0FBQ3ZILElBQUksaUJBQWtHLENBQUM7QUFDdkcsSUFBSSxvQkFBMkcsQ0FBQztBQUNoSCxJQUFJLGlCQUFrRyxDQUFDO0FBQ3ZHLElBQUksdUJBQW9ILENBQUM7QUFDekgsSUFBSSxvQkFBMkcsQ0FBQztBQUVoSCxJQUFJLFVBQTRCLENBQUM7QUFDakMsSUFBSSxHQUFvQixDQUFDO0FBRXpCLE1BQU0sWUFBWSxHQUFHLGtCQUFrQixDQUFDO0FBQ3hDLE1BQU0sR0FBRyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDLGtDQUFrQztBQUVuRSxTQUFTLGtCQUFrQixDQUFDLFVBQTZDO0lBQ3ZFLE1BQU0sT0FBTyxHQUFHLElBQUksa0JBQU8sRUFBRSxDQUFDO0lBQzdCLGlCQUFtQixDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsaUJBQVcsQ0FBQyxTQUFTLENBQUMsSUFBQSw2QkFBa0IsRUFBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzVILENBQUM7QUFFRCxTQUFTLEVBQUUsQ0FBQyxLQU1YO0lBQ0MsT0FBTyxJQUFJLHNCQUFnQixDQUFDO1FBQzFCLFdBQVcsRUFBRSxHQUFH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QztJQUN4SCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgaW1wb3J0L29yZGVyICovXG5cbmNvbnN0IG1vY2tHYXJiYWdlQ29sbGVjdCA9IGplc3QuZm4oKTtcblxuaW1wb3J0IHsgR2FyYmFnZUNvbGxlY3RvciwgVG9vbGtpdEluZm8gfSBmcm9tICcuLi8uLi9saWIvYXBpJztcbmltcG9ydCB7IEFjdGl2ZUFzc2V0Q2FjaGUsIEJhY2tncm91bmRTdGFja1JlZnJlc2gsIEJhY2tncm91bmRTdGFja1JlZnJlc2hQcm9wcyB9IGZyb20gJy4uLy4uL2xpYi9hcGkvZ2FyYmFnZS1jb2xsZWN0aW9uL3N0YWNrLXJlZnJlc2gnO1xuaW1wb3J0IHsgbW9ja0Jvb3RzdHJhcFN0YWNrLCBNb2NrU2RrLCBNb2NrU2RrUHJvdmlkZXIgfSBmcm9tICcuLi91dGlsL21vY2stc2RrJztcblxubGV0IGdhcmJhZ2VDb2xsZWN0b3I6IEdhcmJhZ2VDb2xsZWN0b3I7XG5sZXQgbW9ja0xpc3RTdGFja3M6IChwYXJhbXM6IEFXUy5DbG91ZEZvcm1hdGlvbi5UeXBlcy5MaXN0U3RhY2tzSW5wdXQpID0+IEFXUy5DbG91ZEZvcm1hdGlvbi5UeXBlcy5MaXN0U3RhY2tzT3V0cHV0O1xubGV0IG1vY2tEZXNjcmliZVN0YWNrczogKHBhcmFtczogQVdTLkNsb3VkRm9ybWF0aW9uLlR5cGVzLkRlc2NyaWJlU3RhY2tzSW5wdXQpID0+IEFXUy5DbG91ZEZvcm1hdGlvbi5UeXBlcy5EZXNjcmliZVN0YWNrc091dHB1dDtcbmxldCBtb2NrR2V0VGVtcGxhdGVTdW1tYXJ5OiAocGFyYW1zOiBBV1MuQ2xvdWRGb3JtYXRpb24uVHlwZXMuR2V0VGVtcGxhdGVTdW1tYXJ5SW5wdXQpID0+IEFXUy5DbG91ZEZvcm1hdGlvbi5UeXBlcy5HZXRUZW1wbGF0ZVN1bW1hcnlPdXRwdXQ7XG5sZXQgbW9ja0dldFRlbXBsYXRlOiAocGFyYW1zOiBBV1MuQ2xvdWRGb3JtYXRpb24uVHlwZXMuR2V0VGVtcGxhdGVJbnB1dCkgPT4gQVdTLkNsb3VkRm9ybWF0aW9uLlR5cGVzLkdldFRlbXBsYXRlT3V0cHV0O1xubGV0IG1vY2tMaXN0T2JqZWN0c1YyOiAocGFyYW1zOiBBV1MuUzMuVHlwZXMuTGlzdE9iamVjdHNWMlJlcXVlc3QpID0+IEFXUy5TMy5UeXBlcy5MaXN0T2JqZWN0c1YyT3V0cHV0O1xubGV0IG1vY2tHZXRPYmplY3RUYWdnaW5nOiAocGFyYW1zOiBBV1MuUzMuVHlwZXMuR2V0T2JqZWN0VGFnZ2luZ1JlcXVlc3QpID0+IEFXUy5TMy5UeXBlcy5HZXRPYmplY3RUYWdnaW5nT3V0cHV0O1xubGV0IG1vY2tEZWxldGVPYmplY3RzOiAocGFyYW1zOiBBV1MuUzMuVHlwZXMuRGVsZXRlT2JqZWN0c1JlcXVlc3QpID0+IEFXUy5TMy5UeXBlcy5EZWxldGVPYmplY3RzT3V0cHV0O1xubGV0IG1vY2tEZWxldGVPYmplY3RUYWdnaW5nOiAocGFyYW1zOiBBV1MuUzMuVHlwZXMuRGVsZXRlT2JqZWN0VGFnZ2luZ1JlcXVlc3QpID0+IEFXUy5TMy5UeXBlcy5EZWxldGVPYmplY3RUYWdnaW5nT3V0cHV0O1xubGV0IG1vY2tQdXRPYmplY3RUYWdnaW5nOiAocGFyYW1zOiBBV1MuUzMuVHlwZXMuUHV0T2JqZWN0VGFnZ2luZ1JlcXVlc3QpID0+IEFXUy5TMy5UeXBlcy5QdXRPYmplY3RUYWdnaW5nT3V0cHV0O1xuXG5sZXQgc3RkZXJyTW9jazogamVzdC5TcHlJbnN0YW5jZTtcbmxldCBzZGs6IE1vY2tTZGtQcm92aWRlcjtcblxuY29uc3QgSVNPTEFURURfVEFHID0gJ2F3cy1jZGs6aXNvbGF0ZWQnO1xuY29uc3QgREFZID0gMjQgKiA2MCAqIDYwICogMTAwMDsgLy8gTnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBpbiBhIGRheVxuXG5mdW5jdGlvbiBtb2NrVGhlVG9vbGtpdEluZm8oc3RhY2tQcm9wczogUGFydGlhbDxBV1MuQ2xvdWRGb3JtYXRpb24uU3RhY2s+KSB7XG4gIGNvbnN0IG1vY2tTZGsgPSBuZXcgTW9ja1NkaygpO1xuICAoVG9vbGtpdEluZm8gYXMgYW55KS5sb29rdXAgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoVG9vbGtpdEluZm8uZnJvbVN0YWNrKG1vY2tCb290c3RyYXBTdGFjayhtb2NrU2RrLCBzdGFja1Byb3BzKSkpO1xufVxuXG5mdW5jdGlvbiBnYyhwcm9wczoge1xuICB0eXBlOiAnczMnIHwgJ2VjcicgfCAnYWxsJztcbiAgcm9sbGJhY2tCdWZmZXJEYXlzPzogbnVtYmVyO1xuICBjcmVhdGVkQXRCdWZmZXJEYXlzPzogbnVtYmVyO1xuICBhY3Rpb246ICdmdWxsJyB8ICdwcmludCcgfCAndGFnJyB8ICdkZWxldGUtdGFnZ2VkJztcbiAgbWF4V2FpdFRpbWU/OiBudW1iZXI7XG59KTogR2FyYmFnZUNvbGxlY3RvciB7XG4gIHJldHVybiBuZXcgR2FyYmFnZUNvbGxlY3Rvcih7XG4gICAgc2RrUHJvdmlkZXI6IHNkayxcbiAgICBhY3Rpb246IHByb3BzLmFjdGlvbixcbiAgICByZXNvbHZlZEVudmlyb25tZW50OiB7XG4gICAgICBhY2NvdW50OiAnMTIzNDU2Nzg5MDEyJyxcbiAgICAgIHJlZ2lvbjogJ3VzLWVhc3QtMScsXG4gICAgICBuYW1lOiAnbW9jaycsXG4gICAgfSxcbiAgICBib290c3RyYXBTdGFja05hbWU6ICdHYXJiYWdlU3RhY2snLFxuICAgIHJvbGxiYWNrQnVmZmVyRGF5czogcHJvcHMucm9sbGJhY2tCdWZmZXJEYXlzID8/IDAsXG4gICAgY3JlYXRlZEJ1ZmZlckRheXM6IHByb3BzLmNyZWF0ZWRBdEJ1ZmZlckRheXMgPz8gMCxcbiAgICB0eXBlOiBwcm9wcy50eXBlLFxuICAgIG1heFdhaXRUaW1lOiBwcm9wcy5tYXhXYWl0VGltZSxcbiAgICBjb25maXJtOiBmYWxzZSxcbiAgfSk7XG59XG5cbmJlZm9yZUVhY2goKCkgPT4ge1xuICBzZGsgPSBuZXcgTW9ja1Nka1Byb3ZpZGVyKHsgcmVhbFNkazogZmFsc2UgfSk7XG4gIC8vIEJ5IGRlZmF1bHQsIHdlJ2xsIHJldHVybiBhIG5vbi1mb3VuZCB0b29sa2l0IGluZm9cbiAgKFRvb2xraXRJbmZvIGFzIGFueSkubG9va3VwID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFRvb2xraXRJbmZvLmJvb3RzdHJhcFN0YWNrTm90Rm91bmRJbmZvKCdHYXJiYWdlU3RhY2snKSk7XG4gIHN0ZGVyck1vY2sgPSBqZXN0LnNweU9uKHByb2Nlc3Muc3RkZXJyLCAnd3JpdGUnKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4geyByZXR1cm4gdHJ1ZTsgfSk7XG59KTtcblxuYWZ0ZXJFYWNoKCgpID0+IHtcbiAgc3RkZXJyTW9jay5tb2NrUmVzdG9yZSgpO1xufSk7XG5cbmRlc2NyaWJlKCdHYXJiYWdlIENvbGxlY3Rpb24nLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG1vY2tMaXN0U3RhY2tzID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIFN0YWNrU3VtbWFyaWVzOiBbXG4gICAgICAgIHsgU3RhY2tOYW1lOiAnU3RhY2sxJywgU3RhY2tTdGF0dXM6ICdDUkVBVEVfQ09NUExFVEUnIH0sXG4gICAgICAgIHsgU3RhY2tOYW1lOiAnU3RhY2syJywgU3RhY2tTdGF0dXM6ICdVUERBVEVfQ09NUExFVEUnIH0sXG4gICAgICBdLFxuICAgIH0pO1xuICAgIG1vY2tHZXRUZW1wbGF0ZVN1bW1hcnkgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIFBhcmFtZXRlcnM6IFt7XG4gICAgICAgIFBhcmFtZXRlcktleTogJ0Jvb3RzdHJhcFZlcnNpb24nLFxuICAgICAgICBEZWZhdWx0VmFsdWU6ICcvY2RrLWJvb3RzdHJhcC9hYmNkZS92ZXJzaW9uJyxcbiAgICAgIH1dLFxuICAgIH0pO1xuICAgIG1vY2tHZXRUZW1wbGF0ZSA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgVGVtcGxhdGVCb2R5OiAnYWJjZGUnLFxuICAgIH0pO1xuICAgIG1vY2tMaXN0T2JqZWN0c1YyID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgQ29udGVudHM6IFtcbiAgICAgICAgICB7IEtleTogJ2Fzc2V0MScsIExhc3RNb2RpZmllZDogbmV3IERhdGUoRGF0ZS5ub3coKSAtICgyICogREFZKSkgfSxcbiAgICAgICAgICB7IEtleTogJ2Fzc2V0MicsIExhc3RNb2RpZmllZDogbmV3IERhdGUoRGF0ZS5ub3coKSAtICgxMCAqIERBWSkpIH0sXG4gICAgICAgICAgeyBLZXk6ICdhc3NldDMnLCBMYXN0TW9kaWZpZWQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSAoMTAwICogREFZKSkgfSxcbiAgICAgICAgXSxcbiAgICAgICAgS2V5Q291bnQ6IDMsXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBtb2NrR2V0T2JqZWN0VGFnZ2luZyA9IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKHBhcmFtcykgPT4ge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgIFRhZ1NldDogcGFyYW1zLktleSA9PT0gJ2Fzc2V0MicgPyBbeyBLZXk6IElTT0xBVEVEX1RBRywgVmFsdWU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9XSA6IFtdLFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgbW9ja1B1dE9iamVjdFRhZ2dpbmcgPSBqZXN0LmZuKCk7XG4gICAgbW9ja0RlbGV0ZU9iamVjdHMgPSBqZXN0LmZuKCk7XG4gICAgbW9ja0RlbGV0ZU9iamVjdFRhZ2dpbmcgPSBqZXN0LmZuKCk7XG4gICAgbW9ja0Rlc2NyaWJlU3RhY2tzID0gamVzdC5mbigpO1xuXG4gICAgc2RrLnN0dWJDbG91ZEZvcm1hdGlvbih7XG4gICAgICBsaXN0U3RhY2tzOiBtb2NrTGlzdFN0YWNrcyxcbiAgICAgIGdldFRlbXBsYXRlU3VtbWFyeTogbW9ja0dldFRlbXBsYXRlU3VtbWFyeSxcbiAgICAgIGdldFRlbXBsYXRlOiBtb2NrR2V0VGVtcGxhdGUsXG4gICAgICBkZXNjcmliZVN0YWNrczogbW9ja0Rlc2NyaWJlU3RhY2tzLFxuICAgIH0pO1xuICAgIHNkay5zdHViUzMoe1xuICAgICAgbGlzdE9iamVjdHNWMjogbW9ja0xpc3RPYmplY3RzVjIsXG4gICAgICBnZXRPYmplY3RUYWdnaW5nOiBtb2NrR2V0T2JqZWN0VGFnZ2luZyxcbiAgICAgIGRlbGV0ZU9iamVjdHM6IG1vY2tEZWxldGVPYmplY3RzLFxuICAgICAgZGVsZXRlT2JqZWN0VGFnZ2luZzogbW9ja0RlbGV0ZU9iamVjdFRhZ2dpbmcsXG4gICAgICBwdXRPYmplY3RUYWdnaW5nOiBtb2NrUHV0T2JqZWN0VGFnZ2luZyxcbiAgICB9KTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBtb2NrR2FyYmFnZUNvbGxlY3QubW9ja0NsZWFyKCk7XG4gIH0pO1xuXG4gIHRlc3QoJ3JvbGxiYWNrQnVmZmVyRGF5cyA9IDAgLS0gYXNzZXRzIHRvIGJlIGRlbGV0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja1RoZVRvb2xraXRJbmZvKHtcbiAgICAgIE91dHB1dHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIE91dHB1dEtleTogJ0Jvb3RzdHJhcFZlcnNpb24nLFxuICAgICAgICAgIE91dHB1dFZhbHVlOiAnOTk5JyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBnYXJiYWdlQ29sbGVjdG9yID0gZ2Moe1xuICAgICAgdHlwZTogJ3MzJyxcbiAgICAgIHJvbGxiYWNrQnVmZmVyRGF5czogMCxcbiAgICAgIGFjdGlvbjogJ2Z1bGwnLFxuICAgIH0pO1xuICAgIGF3YWl0IGdhcmJhZ2VDb2xsZWN0b3IuZ2FyYmFnZUNvbGxlY3QoKTtcblxuICAgIGV4cGVjdChtb2NrTGlzdFN0YWNrcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIGV4cGVjdChtb2NrTGlzdE9iamVjdHNWMikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgIC8vIG5vIHRhZ2dpbmdcbiAgICBleHBlY3QobW9ja0dldE9iamVjdFRhZ2dpbmcpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcbiAgICBleHBlY3QobW9ja1B1dE9iamVjdFRhZ2dpbmcpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcblxuICAgIC8vIGFzc2V0cyBhcmUgdG8gYmUgZGVsZXRlZFxuICAgIGV4cGVjdChtb2NrRGVsZXRlT2JqZWN0cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgQnVja2V0OiAnQlVDS0VUX05BTUUnLFxuICAgICAgRGVsZXRlOiB7XG4gICAgICAgIE9iamVjdHM6IFtcbiAgICAgICAgICB7IEtleTogJ2Fzc2V0MScgfSxcbiAgICAgICAgICB7IEtleTogJ2Fzc2V0MicgfSxcbiAgICAgICAgICB7IEtleTogJ2Fzc2V0MycgfSxcbiAgICAgICAgXSxcbiAgICAgICAgUXVpZXQ6IHRydWUsXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdyb2xsYmFja0J1ZmZlckRheXMgPiAwIC0tIGFzc2V0cyB0byBiZSB0YWdnZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja1RoZVRvb2xraXRJbmZvKHtcbiAgICAgIE91dHB1dHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIE91dHB1dEtleTogJ0Jvb3RzdHJhcFZlcnNpb24nLFxuICAgICAgICAgIE91dHB1dFZhbHVlOiAnOTk5JyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBnYXJiYWdlQ29sbGVjdG9yID0gZ2Moe1xuICAgICAgdHlwZTogJ3MzJyxcbiAgICAgIHJvbGxiYWNrQnVmZmVyRGF5czogMyxcbiAgICAgIGFjdGlvbjogJ2Z1bGwnLFxuICAgIH0pO1xuICAgIGF3YWl0IGdhcmJhZ2VDb2xsZWN0b3IuZ2FyYmFnZUNvbGxlY3QoKTtcblxuICAgIGV4cGVjdChtb2NrTGlzdFN0YWNrcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIGV4cGVjdChtb2NrTGlzdE9iamVjdHNWMikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuXG4gICAgLy8gYXNzZXRzIHRhZ2dlZFxuICAgIGV4cGVjdChtb2NrR2V0T2JqZWN0VGFnZ2luZykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDMpO1xuICAgIGV4cGVjdChtb2NrUHV0T2JqZWN0VGFnZ2luZykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpOyAvLyBvbmUgYXNzZXQgYWxyZWFkeSBoYXMgdGhlIHRhZ1xuXG4gICAgLy8gbm8gZGVsZXRpbmdcbiAgICBleHBlY3QobW9ja0RlbGV0ZU9iamVjdHMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcbiAgfSk7XG5cbiAgdGVzdCgndHlwZSA9IGVjciAtLSB0aHJvd3MgZXJyb3InLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja1RoZVRvb2xraXRJbmZvKHtcbiAgICAgIE91dHB1dHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIE91dHB1dEtleTogJ0Jvb3RzdHJhcFZlcnNpb24nLFxuICAgICAgICAgIE91dHB1dFZhbHVlOiAnOTk5JyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBleHBlY3QoKCkgPT4gZ2FyYmFnZUNvbGxlY3RvciA9IGdjKHtcbiAgICAgIHR5cGU6ICdlY3InLFxuICAgICAgcm9sbGJhY2tCdWZmZXJEYXlzOiAzLFxuICAgICAgYWN0aW9uOiAnZnVsbCcsXG4gICAgfSkpLnRvVGhyb3coL0VDUiBnYXJiYWdlIGNvbGxlY3Rpb24gaXMgbm90IHlldCBzdXBwb3J0ZWQvKTtcbiAgfSk7XG5cbiAgdGVzdCgnY3JlYXRlZEF0QnVmZmVyRGF5cyA+IDAgLS0gYXNzZXRzIHRvIGJlIHRhZ2dlZCcsIGFzeW5jICgpID0+IHtcbiAgICBtb2NrVGhlVG9vbGtpdEluZm8oe1xuICAgICAgT3V0cHV0czogW1xuICAgICAgICB7XG4gICAgICAgICAgT3V0cHV0S2V5OiAnQm9vdHN0cmFwVmVyc2lvbicsXG4gICAgICAgICAgT3V0cHV0VmFsdWU6ICc5OTknLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KTtcblxuICAgIGdhcmJhZ2VDb2xsZWN0b3IgPSBnYyh7XG4gICAgICB0eXBlOiAnczMnLFxuICAgICAgcm9sbGJhY2tCdWZmZXJEYXlzOiAwLFxuICAgICAgY3JlYXRlZEF0QnVmZmVyRGF5czogNSxcbiAgICAgIGFjdGlvbjogJ2Z1bGwnLFxuICAgIH0pO1xuICAgIGF3YWl0IGdhcmJhZ2VDb2xsZWN0b3IuZ2FyYmFnZUNvbGxlY3QoKTtcblxuICAgIGV4cGVjdChtb2NrRGVsZXRlT2JqZWN0cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgQnVja2V0OiAnQlVDS0VUX05BTUUnLFxuICAgICAgRGVsZXRlOiB7XG4gICAgICAgIE9iamVjdHM6IFtcbiAgICAgICAgICB7IEtleTogJ2Fzc2V0MicgfSxcbiAgICAgICAgICB7IEtleTogJ2Fzc2V0MycgfSxcbiAgICAgICAgXSxcbiAgICAgICAgUXVpZXQ6IHRydWUsXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdhY3Rpb24gPSBwcmludCAtLSBkb2VzIG5vdCB0YWcgb3IgZGVsZXRlJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tUaGVUb29sa2l0SW5mbyh7XG4gICAgICBPdXRwdXRzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBPdXRwdXRLZXk6ICdCb290c3RyYXBWZXJzaW9uJyxcbiAgICAgICAgICBPdXRwdXRWYWx1ZTogJzk5OScsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pO1xuXG4gICAgZ2FyYmFnZUNvbGxlY3RvciA9IGdhcmJhZ2VDb2xsZWN0b3IgPSBnYyh7XG4gICAgICB0eXBlOiAnczMnLFxuICAgICAgcm9sbGJhY2tCdWZmZXJEYXlzOiAzLFxuICAgICAgYWN0aW9uOiAncHJpbnQnLFxuICAgIH0pO1xuICAgIGF3YWl0IGdhcmJhZ2VDb2xsZWN0b3IuZ2FyYmFnZUNvbGxlY3QoKTtcblxuICAgIGV4cGVjdChtb2NrTGlzdFN0YWNrcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIGV4cGVjdChtb2NrTGlzdE9iamVjdHNWMikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuXG4gICAgLy8gZ2V0IHRhZ3MsIGJ1dCBkb250IHB1dCB0YWdzXG4gICAgZXhwZWN0KG1vY2tHZXRPYmplY3RUYWdnaW5nKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMyk7XG4gICAgZXhwZWN0KG1vY2tQdXRPYmplY3RUYWdnaW5nKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMCk7XG5cbiAgICAvLyBubyBkZWxldGluZ1xuICAgIGV4cGVjdChtb2NrRGVsZXRlT2JqZWN0cykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDApO1xuICB9KTtcblxuICB0ZXN0KCdhY3Rpb24gPSB0YWcgLS0gZG9lcyBub3QgZGVsZXRlJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tUaGVUb29sa2l0SW5mbyh7XG4gICAgICBPdXRwdXRzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBPdXRwdXRLZXk6ICdCb290c3RyYXBWZXJzaW9uJyxcbiAgICAgICAgICBPdXRwdXRWYWx1ZTogJzk5OScsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pO1xuXG4gICAgZ2FyYmFnZUNvbGxlY3RvciA9IGdhcmJhZ2VDb2xsZWN0b3IgPSBnYyh7XG4gICAgICB0eXBlOiAnczMnLFxuICAgICAgcm9sbGJhY2tCdWZmZXJEYXlzOiAzLFxuICAgICAgYWN0aW9uOiAndGFnJyxcbiAgICB9KTtcbiAgICBhd2FpdCBnYXJiYWdlQ29sbGVjdG9yLmdhcmJhZ2VDb2xsZWN0KCk7XG5cbiAgICBleHBlY3QobW9ja0xpc3RTdGFja3MpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICBleHBlY3QobW9ja0xpc3RPYmplY3RzVjIpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcblxuICAgIC8vIHRhZ3Mgb2JqZWN0c1xuICAgIGV4cGVjdChtb2NrR2V0T2JqZWN0VGFnZ2luZykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDMpO1xuICAgIGV4cGVjdChtb2NrUHV0T2JqZWN0VGFnZ2luZykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpOyAvLyBvbmUgb2JqZWN0IGFscmVhZHkgaGFzIHRoZSB0YWdcblxuICAgIC8vIG5vIGRlbGV0aW5nXG4gICAgZXhwZWN0KG1vY2tEZWxldGVPYmplY3RzKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMCk7XG4gIH0pO1xuXG4gIHRlc3QoJ2FjdGlvbiA9IGRlbGV0ZS10YWdnZWQgLS0gZG9lcyBub3QgdGFnJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tUaGVUb29sa2l0SW5mbyh7XG4gICAgICBPdXRwdXRzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBPdXRwdXRLZXk6ICdCb290c3RyYXBWZXJzaW9uJyxcbiAgICAgICAgICBPdXRwdXRWYWx1ZTogJzk5OScsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pO1xuXG4gICAgZ2FyYmFnZUNvbGxlY3RvciA9IGdhcmJhZ2VDb2xsZWN0b3IgPSBnYyh7XG4gICAgICB0eXBlOiAnczMnLFxuICAgICAgcm9sbGJhY2tCdWZmZXJEYXlzOiAzLFxuICAgICAgYWN0aW9uOiAnZGVsZXRlLXRhZ2dlZCcsXG4gICAgfSk7XG4gICAgYXdhaXQgZ2FyYmFnZUNvbGxlY3Rvci5nYXJiYWdlQ29sbGVjdCgpO1xuXG4gICAgZXhwZWN0KG1vY2tMaXN0U3RhY2tzKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgZXhwZWN0KG1vY2tMaXN0T2JqZWN0c1YyKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG5cbiAgICAvLyBnZXQgdGFncywgYnV0IGRvbnQgcHV0IHRhZ3NcbiAgICBleHBlY3QobW9ja0dldE9iamVjdFRhZ2dpbmcpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygzKTtcbiAgICBleHBlY3QobW9ja1B1dE9iamVjdFRhZ2dpbmcpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcbiAgfSk7XG5cbiAgdGVzdCgnaWdub3JlIG9iamVjdHMgdGhhdCBhcmUgbW9kaWZpZWQgYWZ0ZXIgZ2Mgc3RhcnQnLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja1RoZVRvb2xraXRJbmZvKHtcbiAgICAgIE91dHB1dHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIE91dHB1dEtleTogJ0Jvb3RzdHJhcFZlcnNpb24nLFxuICAgICAgICAgIE91dHB1dFZhbHVlOiAnOTk5JyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2NrTGlzdE9iamVjdHNWMkZ1dHVyZSA9IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgIENvbnRlbnRzOiBbXG4gICAgICAgICAgeyBLZXk6ICdhc3NldDEnLCBMYXN0TW9kaWZpZWQ6IG5ldyBEYXRlKDApIH0sXG4gICAgICAgICAgeyBLZXk6ICdhc3NldDInLCBMYXN0TW9kaWZpZWQ6IG5ldyBEYXRlKDApIH0sXG4gICAgICAgICAgeyBLZXk6ICdhc3NldDMnLCBMYXN0TW9kaWZpZWQ6IG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0RnVsbFllYXIobmV3IERhdGUoKS5nZXRGdWxsWWVhcigpICsgMSkpIH0sIC8vIGZ1dHVyZSBkYXRlIGlnbm9yZWQgZXZlcnl3aGVyZVxuICAgICAgICBdLFxuICAgICAgICBLZXlDb3VudDogMyxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgc2RrLnN0dWJTMyh7XG4gICAgICBsaXN0T2JqZWN0c1YyOiBtb2NrTGlzdE9iamVjdHNWMkZ1dHVyZSxcbiAgICAgIGdldE9iamVjdFRhZ2dpbmc6IG1vY2tHZXRPYmplY3RUYWdnaW5nLFxuICAgICAgZGVsZXRlT2JqZWN0czogbW9ja0RlbGV0ZU9iamVjdHMsXG4gICAgICBwdXRPYmplY3RUYWdnaW5nOiBtb2NrUHV0T2JqZWN0VGFnZ2luZyxcbiAgICB9KTtcblxuICAgIGdhcmJhZ2VDb2xsZWN0b3IgPSBnYXJiYWdlQ29sbGVjdG9yID0gZ2Moe1xuICAgICAgdHlwZTogJ3MzJyxcbiAgICAgIHJvbGxiYWNrQnVmZmVyRGF5czogMCxcbiAgICAgIGFjdGlvbjogJ2Z1bGwnLFxuICAgIH0pO1xuICAgIGF3YWl0IGdhcmJhZ2VDb2xsZWN0b3IuZ2FyYmFnZUNvbGxlY3QoKTtcblxuICAgIC8vIGFzc2V0cyBhcmUgdG8gYmUgZGVsZXRlZFxuICAgIGV4cGVjdChtb2NrRGVsZXRlT2JqZWN0cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgQnVja2V0OiAnQlVDS0VUX05BTUUnLFxuICAgICAgRGVsZXRlOiB7XG4gICAgICAgIE9iamVjdHM6IFtcbiAgICAgICAgICB7IEtleTogJ2Fzc2V0MScgfSxcbiAgICAgICAgICB7IEtleTogJ2Fzc2V0MicgfSxcbiAgICAgICAgICAvLyBubyBhc3NldDNcbiAgICAgICAgXSxcbiAgICAgICAgUXVpZXQ6IHRydWUsXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdib290c3RyYXAgZmlsdGVycyBvdXQgb3RoZXIgYm9vdHN0cmFwIHZlcnNpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tUaGVUb29sa2l0SW5mbyh7XG4gICAgICBQYXJhbWV0ZXJzOiBbe1xuICAgICAgICBQYXJhbWV0ZXJLZXk6ICdRdWFsaWZpZXInLFxuICAgICAgICBQYXJhbWV0ZXJWYWx1ZTogJ3p6enp6eicsXG4gICAgICB9XSxcbiAgICAgIE91dHB1dHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIE91dHB1dEtleTogJ0Jvb3RzdHJhcFZlcnNpb24nLFxuICAgICAgICAgIE91dHB1dFZhbHVlOiAnOTk5JyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBnYXJiYWdlQ29sbGVjdG9yID0gZ2FyYmFnZUNvbGxlY3RvciA9IGdjKHtcbiAgICAgIHR5cGU6ICdzMycsXG4gICAgICByb2xsYmFja0J1ZmZlckRheXM6IDMsXG4gICAgICBhY3Rpb246ICdmdWxsJyxcbiAgICB9KTtcbiAgICBhd2FpdCBnYXJiYWdlQ29sbGVjdG9yLmdhcmJhZ2VDb2xsZWN0KCk7XG5cbiAgICBleHBlY3QobW9ja0dldFRlbXBsYXRlU3VtbWFyeSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgIGV4cGVjdChtb2NrR2V0VGVtcGxhdGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcbiAgfSk7XG5cbiAgdGVzdCgncGFyYW1ldGVyIGhhc2hlcyBhcmUgaW5jbHVkZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja1RoZVRvb2xraXRJbmZvKHtcbiAgICAgIE91dHB1dHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIE91dHB1dEtleTogJ0Jvb3RzdHJhcFZlcnNpb24nLFxuICAgICAgICAgIE91dHB1dFZhbHVlOiAnOTk5JyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2NrR2V0VGVtcGxhdGVTdW1tYXJ5QXNzZXRzID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBQYXJhbWV0ZXJzOiBbe1xuICAgICAgICBQYXJhbWV0ZXJLZXk6ICdBc3NldFBhcmFtZXRlcnNhc3NldDEnLFxuICAgICAgICBEZWZhdWx0VmFsdWU6ICdhc3NldDEnLFxuICAgICAgfV0sXG4gICAgfSk7XG5cbiAgICBzZGsuc3R1YkNsb3VkRm9ybWF0aW9uKHtcbiAgICAgIGxpc3RTdGFja3M6IG1vY2tMaXN0U3RhY2tzLFxuICAgICAgZ2V0VGVtcGxhdGVTdW1tYXJ5OiBtb2NrR2V0VGVtcGxhdGVTdW1tYXJ5QXNzZXRzLFxuICAgICAgZ2V0VGVtcGxhdGU6IG1vY2tHZXRUZW1wbGF0ZSxcbiAgICB9KTtcblxuICAgIGdhcmJhZ2VDb2xsZWN0b3IgPSBnYXJiYWdlQ29sbGVjdG9yID0gZ2Moe1xuICAgICAgdHlwZTogJ3MzJyxcbiAgICAgIHJvbGxiYWNrQnVmZmVyRGF5czogMCxcbiAgICAgIGFjdGlvbjogJ2Z1bGwnLFxuICAgIH0pO1xuICAgIGF3YWl0IGdhcmJhZ2VDb2xsZWN0b3IuZ2FyYmFnZUNvbGxlY3QoKTtcblxuICAgIGV4cGVjdChtb2NrTGlzdFN0YWNrcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIGV4cGVjdChtb2NrTGlzdE9iamVjdHNWMikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgIC8vIG5vIHRhZ2dpbmdcbiAgICBleHBlY3QobW9ja0dldE9iamVjdFRhZ2dpbmcpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcbiAgICBleHBlY3QobW9ja1B1dE9iamVjdFRhZ2dpbmcpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcblxuICAgIC8vIGFzc2V0cyBhcmUgdG8gYmUgZGVsZXRlZFxuICAgIGV4cGVjdChtb2NrRGVsZXRlT2JqZWN0cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgQnVja2V0OiAnQlVDS0VUX05BTUUnLFxuICAgICAgRGVsZXRlOiB7XG4gICAgICAgIE9iamVjdHM6IFtcbiAgICAgICAgICAvLyBubyAnYXNzZXQxJ1xuICAgICAgICAgIHsgS2V5OiAnYXNzZXQyJyB9LFxuICAgICAgICAgIHsgS2V5OiAnYXNzZXQzJyB9LFxuICAgICAgICBdLFxuICAgICAgICBRdWlldDogdHJ1ZSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3N0YWNrU3RhdHVzIGluIFJFVklFV19JTl9QUk9HUkVTUyBtZWFucyB3ZSB3YWl0IHVudGlsIGl0IGNoYW5nZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja1RoZVRvb2xraXRJbmZvKHtcbiAgICAgIE91dHB1dHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIE91dHB1dEtleTogJ0Jvb3RzdHJhcFZlcnNpb24nLFxuICAgICAgICAgIE91dHB1dFZhbHVlOiAnOTk5JyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBNb2NrIHRoZSBsaXN0U3RhY2tzIGNhbGxcbiAgICBjb25zdCBtb2NrTGlzdFN0YWNrc1N0YXR1cyA9IGplc3QuZm4oKVxuICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIFN0YWNrU3VtbWFyaWVzOiBbXG4gICAgICAgICAgeyBTdGFja05hbWU6ICdTdGFjazEnLCBTdGFja1N0YXR1czogJ1JFVklFV19JTl9QUk9HUkVTUycgfSxcbiAgICAgICAgICB7IFN0YWNrTmFtZTogJ1N0YWNrMicsIFN0YWNrU3RhdHVzOiAnVVBEQVRFX0NPTVBMRVRFJyB9LFxuICAgICAgICBdLFxuICAgICAgfSlcbiAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBTdGFja1N1bW1hcmllczogW1xuICAgICAgICAgIHsgU3RhY2tOYW1lOiAnU3RhY2sxJywgU3RhY2tTdGF0dXM6ICdVUERBVEVfQ09NUExFVEUnIH0sXG4gICAgICAgICAgeyBTdGFja05hbWU6ICdTdGFjazInLCBTdGFja1N0YXR1czogJ1VQREFURV9DT01QTEVURScgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuXG4gICAgc2RrLnN0dWJDbG91ZEZvcm1hdGlvbih7XG4gICAgICBsaXN0U3RhY2tzOiBtb2NrTGlzdFN0YWNrc1N0YXR1cyxcbiAgICAgIGdldFRlbXBsYXRlU3VtbWFyeTogbW9ja0dldFRlbXBsYXRlU3VtbWFyeSxcbiAgICAgIGdldFRlbXBsYXRlOiBtb2NrR2V0VGVtcGxhdGUsXG4gICAgfSk7XG5cbiAgICBnYXJiYWdlQ29sbGVjdG9yID0gZ2FyYmFnZUNvbGxlY3RvciA9IGdjKHtcbiAgICAgIHR5cGU6ICdzMycsXG4gICAgICByb2xsYmFja0J1ZmZlckRheXM6IDMsXG4gICAgICBhY3Rpb246ICdmdWxsJyxcbiAgICB9KTtcbiAgICBhd2FpdCBnYXJiYWdlQ29sbGVjdG9yLmdhcmJhZ2VDb2xsZWN0KCk7XG5cbiAgICAvLyBsaXN0IGFyZSBjYWxsZWQgYXMgZXhwZWN0ZWRcbiAgICBleHBlY3QobW9ja0xpc3RTdGFja3NTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcblxuICAgIC8vIGV2ZXJ5dGhpbmcgZWxzZSBydW5zIGFzIGV4cGVjdGVkOlxuICAgIC8vIGFzc2V0cyB0YWdnZWRcbiAgICBleHBlY3QobW9ja0dldE9iamVjdFRhZ2dpbmcpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygzKTtcbiAgICBleHBlY3QobW9ja1B1dE9iamVjdFRhZ2dpbmcpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTsgLy8gb25lIG9iamVjdCBhbHJlYWR5IGhhcyB0aGUgdGFnXG5cbiAgICAvLyBubyBkZWxldGluZ1xuICAgIGV4cGVjdChtb2NrRGVsZXRlT2JqZWN0cykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDApO1xuICB9LCA2MDAwMCk7XG5cbiAgdGVzdCgnZmFpbHMgd2hlbiBzdGFja1N0YXR1cyBzdHVjayBpbiBSRVZJRVdfSU5fUFJPR1JFU1MnLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja1RoZVRvb2xraXRJbmZvKHtcbiAgICAgIE91dHB1dHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIE91dHB1dEtleTogJ0Jvb3RzdHJhcFZlcnNpb24nLFxuICAgICAgICAgIE91dHB1dFZhbHVlOiAnOTk5JyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBNb2NrIHRoZSBsaXN0U3RhY2tzIGNhbGxcbiAgICBjb25zdCBtb2NrTGlzdFN0YWNrc1N0YXR1cyA9IGplc3QuZm4oKVxuICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgU3RhY2tTdW1tYXJpZXM6IFtcbiAgICAgICAgICB7IFN0YWNrTmFtZTogJ1N0YWNrMScsIFN0YWNrU3RhdHVzOiAnUkVWSUVXX0lOX1BST0dSRVNTJyB9LFxuICAgICAgICAgIHsgU3RhY2tOYW1lOiAnU3RhY2syJywgU3RhY2tTdGF0dXM6ICdVUERBVEVfQ09NUExFVEUnIH0sXG4gICAgICAgIF0sXG4gICAgICB9KTtcblxuICAgIHNkay5zdHViQ2xvdWRGb3JtYXRpb24oe1xuICAgICAgbGlzdFN0YWNrczogbW9ja0xpc3RTdGFja3NTdGF0dXMsXG4gICAgICBnZXRUZW1wbGF0ZVN1bW1hcnk6IG1vY2tHZXRUZW1wbGF0ZVN1bW1hcnksXG4gICAgICBnZXRUZW1wbGF0ZTogbW9ja0dldFRlbXBsYXRlLFxuICAgIH0pO1xuXG4gICAgZ2FyYmFnZUNvbGxlY3RvciA9IGdhcmJhZ2VDb2xsZWN0b3IgPSBnYyh7XG4gICAgICB0eXBlOiAnczMnLFxuICAgICAgcm9sbGJhY2tCdWZmZXJEYXlzOiAzLFxuICAgICAgYWN0aW9uOiAnZnVsbCcsXG4gICAgICBtYXhXYWl0VGltZTogNjAwLCAvLyBXYWl0IG9ubHkgNjAwIG1zIGluIHRlc3RzXG4gICAgfSk7XG5cbiAgICBhd2FpdCBleHBlY3QoZ2FyYmFnZUNvbGxlY3Rvci5nYXJiYWdlQ29sbGVjdCgpKS5yZWplY3RzLnRvVGhyb3coL1N0YWNrcyBzdGlsbCBpbiBSRVZJRVdfSU5fUFJPR1JFU1Mgc3RhdGUgYWZ0ZXIgd2FpdGluZy8pO1xuICB9LCA2MDAwMCk7XG59KTtcblxubGV0IG1vY2tMaXN0T2JqZWN0c1YyTGFyZ2U6IChwYXJhbXM6IEFXUy5TMy5UeXBlcy5MaXN0T2JqZWN0c1YyUmVxdWVzdCkgPT4gQVdTLlMzLlR5cGVzLkxpc3RPYmplY3RzVjJPdXRwdXQ7XG5sZXQgbW9ja0dldE9iamVjdFRhZ2dpbmdMYXJnZTogKHBhcmFtczogQVdTLlMzLlR5cGVzLkdldE9iamVjdFRhZ2dpbmdSZXF1ZXN0KSA9PiBBV1MuUzMuVHlwZXMuR2V0T2JqZWN0VGFnZ2luZ091dHB1dDtcbmRlc2NyaWJlKCdHYXJiYWdlIENvbGxlY3Rpb24gd2l0aCBsYXJnZSAjIG9mIG9iamVjdHMnLCAoKSA9PiB7XG4gIGNvbnN0IGtleUNvdW50ID0gMTAwMDA7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgbW9ja0xpc3RTdGFja3MgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgU3RhY2tTdW1tYXJpZXM6IFtcbiAgICAgICAgeyBTdGFja05hbWU6ICdTdGFjazEnLCBTdGFja1N0YXR1czogJ0NSRUFURV9DT01QTEVURScgfSxcbiAgICAgIF0sXG4gICAgfSk7XG4gICAgbW9ja0dldFRlbXBsYXRlU3VtbWFyeSA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgUGFyYW1ldGVyczogW3tcbiAgICAgICAgUGFyYW1ldGVyS2V5OiAnQm9vdHN0cmFwVmVyc2lvbicsXG4gICAgICAgIERlZmF1bHRWYWx1ZTogJy9jZGstYm9vdHN0cmFwL2FiY2RlL3ZlcnNpb24nLFxuICAgICAgfV0sXG4gICAgfSk7XG4gICAgLy8gYWRkIGV2ZXJ5IDV0aCBhc3NldCBoYXNoIHRvIHRoZSBtb2NrIHRlbXBsYXRlIGJvZHk6IDgwMDAgYXNzZXRzIGFyZSBpc29sYXRlZFxuICAgIGNvbnN0IG1vY2tUZW1wbGF0ZUJvZHkgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleUNvdW50OyBpKz01KSB7XG4gICAgICBtb2NrVGVtcGxhdGVCb2R5LnB1c2goYGFzc2V0JHtpfWhhc2hgKTtcbiAgICB9XG4gICAgbW9ja0dldFRlbXBsYXRlID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBUZW1wbGF0ZUJvZHk6IG1vY2tUZW1wbGF0ZUJvZHkuam9pbignLScpLFxuICAgIH0pO1xuXG4gICAgY29uc3QgY29udGVudHM6IHsgS2V5OiBzdHJpbmc7IExhc3RNb2RpZmllZDogRGF0ZSB9W10gPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleUNvdW50OyBpKyspIHtcbiAgICAgIGNvbnRlbnRzLnB1c2goe1xuICAgICAgICBLZXk6IGBhc3NldCR7aX1oYXNoYCxcbiAgICAgICAgTGFzdE1vZGlmaWVkOiBuZXcgRGF0ZSgwKSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBtb2NrTGlzdE9iamVjdHNWMkxhcmdlID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgQ29udGVudHM6IGNvbnRlbnRzLFxuICAgICAgICBLZXlDb3VudDoga2V5Q291bnQsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGV2ZXJ5IG90aGVyIG9iamVjdCBoYXMgdGhlIGlzb2xhdGVkIHRhZzogb2YgdGhlIDgwMDAgaXNvbGF0ZWQgYXNzZXRzLCA0MDAwIGFscmVhZHkgYXJlIHRhZ2dlZC5cbiAgICAvLyBvZiB0aGUgMjAwMCBpbiB1c2UgYXNzZXRzLCAxMDAwIGFyZSB0YWdnZWQuXG4gICAgbW9ja0dldE9iamVjdFRhZ2dpbmdMYXJnZSA9IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKHBhcmFtcykgPT4ge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgIFRhZ1NldDogTnVtYmVyKHBhcmFtcy5LZXlbcGFyYW1zLktleS5sZW5ndGggLSA1XSkgJSAyID09PSAwID8gW3sgS2V5OiBJU09MQVRFRF9UQUcsIFZhbHVlOiBuZXcgRGF0ZSgyMDAwLCAxLCAxKS50b0lTT1N0cmluZygpIH1dIDogW10sXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBtb2NrUHV0T2JqZWN0VGFnZ2luZyA9IGplc3QuZm4oKTtcbiAgICBtb2NrRGVsZXRlT2JqZWN0cyA9IGplc3QuZm4oKTtcbiAgICBtb2NrRGVsZXRlT2JqZWN0VGFnZ2luZyA9IGplc3QuZm4oKTtcbiAgICBtb2NrRGVzY3JpYmVTdGFja3MgPSBqZXN0LmZuKCk7XG5cbiAgICBzZGsuc3R1YkNsb3VkRm9ybWF0aW9uKHtcbiAgICAgIGxpc3RTdGFja3M6IG1vY2tMaXN0U3RhY2tzLFxuICAgICAgZ2V0VGVtcGxhdGVTdW1tYXJ5OiBtb2NrR2V0VGVtcGxhdGVTdW1tYXJ5LFxuICAgICAgZ2V0VGVtcGxhdGU6IG1vY2tHZXRUZW1wbGF0ZSxcbiAgICAgIGRlc2NyaWJlU3RhY2tzOiBtb2NrRGVzY3JpYmVTdGFja3MsXG4gICAgfSk7XG4gICAgc2RrLnN0dWJTMyh7XG4gICAgICBsaXN0T2JqZWN0c1YyOiBtb2NrTGlzdE9iamVjdHNWMkxhcmdlLFxuICAgICAgZ2V0T2JqZWN0VGFnZ2luZzogbW9ja0dldE9iamVjdFRhZ2dpbmdMYXJnZSxcbiAgICAgIGRlbGV0ZU9iamVjdHM6IG1vY2tEZWxldGVPYmplY3RzLFxuICAgICAgZGVsZXRlT2JqZWN0VGFnZ2luZzogbW9ja0RlbGV0ZU9iamVjdFRhZ2dpbmcsXG4gICAgICBwdXRPYmplY3RUYWdnaW5nOiBtb2NrUHV0T2JqZWN0VGFnZ2luZyxcbiAgICB9KTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBtb2NrR2FyYmFnZUNvbGxlY3QubW9ja0NsZWFyKCk7XG4gIH0pO1xuXG4gIHRlc3QoJ3RhZyBvbmx5JywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tUaGVUb29sa2l0SW5mbyh7XG4gICAgICBPdXRwdXRzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBPdXRwdXRLZXk6ICdCb290c3RyYXBWZXJzaW9uJyxcbiAgICAgICAgICBPdXRwdXRWYWx1ZTogJzk5OScsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pO1xuXG4gICAgZ2FyYmFnZUNvbGxlY3RvciA9IGdhcmJhZ2VDb2xsZWN0b3IgPSBnYyh7XG4gICAgICB0eXBlOiAnczMnLFxuICAgICAgcm9sbGJhY2tCdWZmZXJEYXlzOiAxLFxuICAgICAgYWN0aW9uOiAndGFnJyxcbiAgICB9KTtcbiAgICBhd2FpdCBnYXJiYWdlQ29sbGVjdG9yLmdhcmJhZ2VDb2xsZWN0KCk7XG5cbiAgICBleHBlY3QobW9ja0xpc3RTdGFja3MpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICBleHBlY3QobW9ja0xpc3RPYmplY3RzVjJMYXJnZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuXG4gICAgLy8gdGFnZ2luZyBpcyBwZXJmb3JtZWRcbiAgICBleHBlY3QobW9ja0dldE9iamVjdFRhZ2dpbmdMYXJnZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKGtleUNvdW50KTtcbiAgICBleHBlY3QobW9ja0RlbGV0ZU9iamVjdFRhZ2dpbmcpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxMDAwKTsgLy8gMTAwMCBpbiB1c2UgYXNzZXRzIGFyZSBlcnJvbmVvdXNseSB0YWdnZWRcbiAgICBleHBlY3QobW9ja1B1dE9iamVjdFRhZ2dpbmcpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcyg1MDAwKTsgLy8gODAwMC00MDAwIGFzc2V0cyBuZWVkIHRvIGJlIHRhZ2dlZCwgKyAxMDAwIChzaW5jZSB1bnRhZyBhbHNvIGNhbGxzIHRoaXMpXG4gIH0pO1xuXG4gIHRlc3QoJ2RlbGV0ZS10YWdnZWQgb25seScsIGFzeW5jICgpID0+IHtcbiAgICBtb2NrVGhlVG9vbGtpdEluZm8oe1xuICAgICAgT3V0cHV0czogW1xuICAgICAgICB7XG4gICAgICAgICAgT3V0cHV0S2V5OiAnQm9vdHN0cmFwVmVyc2lvbicsXG4gICAgICAgICAgT3V0cHV0VmFsdWU6ICc5OTknLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KTtcblxuICAgIGdhcmJhZ2VDb2xsZWN0b3IgPSBnYXJiYWdlQ29sbGVjdG9yID0gZ2Moe1xuICAgICAgdHlwZTogJ3MzJyxcbiAgICAgIHJvbGxiYWNrQnVmZmVyRGF5czogMSxcbiAgICAgIGFjdGlvbjogJ2RlbGV0ZS10YWdnZWQnLFxuICAgIH0pO1xuICAgIGF3YWl0IGdhcmJhZ2VDb2xsZWN0b3IuZ2FyYmFnZUNvbGxlY3QoKTtcblxuICAgIGV4cGVjdChtb2NrTGlzdFN0YWNrcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIGV4cGVjdChtb2NrTGlzdE9iamVjdHNWMkxhcmdlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG5cbiAgICAvLyBkZWxldGUgcHJldmlvdXNseSB0YWdnZWQgb2JqZWN0c1xuICAgIGV4cGVjdChtb2NrR2V0T2JqZWN0VGFnZ2luZ0xhcmdlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoa2V5Q291bnQpO1xuICAgIGV4cGVjdChtb2NrRGVsZXRlT2JqZWN0cykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDQpOyAvLyA0MDAwIGlzb2xhdGVkIGFzc2V0cyBhcmUgYWxyZWFkeSB0YWdnZWQsIGRlbGV0ZWQgaW4gYmF0Y2hlcyBvZiAxMDAwXG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdCYWNrZ3JvdW5kU3RhY2tSZWZyZXNoJywgKCkgPT4ge1xuICBsZXQgYmFja2dyb3VuZFJlZnJlc2g6IEJhY2tncm91bmRTdGFja1JlZnJlc2g7XG4gIGxldCByZWZyZXNoUHJvcHM6IEJhY2tncm91bmRTdGFja1JlZnJlc2hQcm9wcztcbiAgbGV0IHNldFRpbWVvdXRTcHk6IGplc3QuU3B5SW5zdGFuY2U7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC51c2VGYWtlVGltZXJzKCk7XG4gICAgc2V0VGltZW91dFNweSA9IGplc3Quc3B5T24oZ2xvYmFsLCAnc2V0VGltZW91dCcpO1xuXG4gICAgbW9ja0xpc3RTdGFja3MgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgU3RhY2tTdW1tYXJpZXM6IFtcbiAgICAgICAgeyBTdGFja05hbWU6ICdTdGFjazEnLCBTdGFja1N0YXR1czogJ0NSRUFURV9DT01QTEVURScgfSxcbiAgICAgICAgeyBTdGFja05hbWU6ICdTdGFjazInLCBTdGFja1N0YXR1czogJ1VQREFURV9DT01QTEVURScgfSxcbiAgICAgIF0sXG4gICAgfSk7XG4gICAgbW9ja0dldFRlbXBsYXRlU3VtbWFyeSA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgUGFyYW1ldGVyczogW3tcbiAgICAgICAgUGFyYW1ldGVyS2V5OiAnQm9vdHN0cmFwVmVyc2lvbicsXG4gICAgICAgIERlZmF1bHRWYWx1ZTogJy9jZGstYm9vdHN0cmFwL2FiY2RlL3ZlcnNpb24nLFxuICAgICAgfV0sXG4gICAgfSk7XG4gICAgbW9ja0dldFRlbXBsYXRlID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBUZW1wbGF0ZUJvZHk6ICdhYmNkZScsXG4gICAgfSk7XG5cbiAgICBzZGsuc3R1YkNsb3VkRm9ybWF0aW9uKHtcbiAgICAgIGxpc3RTdGFja3M6IG1vY2tMaXN0U3RhY2tzLFxuICAgICAgZ2V0VGVtcGxhdGVTdW1tYXJ5OiBtb2NrR2V0VGVtcGxhdGVTdW1tYXJ5LFxuICAgICAgZ2V0VGVtcGxhdGU6IG1vY2tHZXRUZW1wbGF0ZSxcbiAgICAgIGRlc2NyaWJlU3RhY2tzOiBqZXN0LmZuKCksXG4gICAgfSk7XG5cbiAgICByZWZyZXNoUHJvcHMgPSB7XG4gICAgICBjZm46IHNkay5tb2NrU2RrLmNsb3VkRm9ybWF0aW9uKCksXG4gICAgICBhY3RpdmVBc3NldHM6IG5ldyBBY3RpdmVBc3NldENhY2hlKCksXG4gICAgICBtYXhXYWl0VGltZTogNjAwMDAsIC8vIDEgbWludXRlXG4gICAgfTtcblxuICAgIGJhY2tncm91bmRSZWZyZXNoID0gbmV3IEJhY2tncm91bmRTdGFja1JlZnJlc2gocmVmcmVzaFByb3BzKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsVGltZXJzKCk7XG4gICAgc2V0VGltZW91dFNweS5tb2NrUmVzdG9yZSgpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgc3RhcnQgYWZ0ZXIgYSBkZWxheScsICgpID0+IHtcbiAgICB2b2lkIGJhY2tncm91bmRSZWZyZXNoLnN0YXJ0KCk7XG4gICAgZXhwZWN0KHNldFRpbWVvdXRTcHkpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICBleHBlY3Qoc2V0VGltZW91dFNweSkudG9IYXZlQmVlbkxhc3RDYWxsZWRXaXRoKGV4cGVjdC5hbnkoRnVuY3Rpb24pLCAzMDAwMDApO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgcmVmcmVzaCBzdGFja3MgYW5kIHNjaGVkdWxlIG5leHQgcmVmcmVzaCcsIGFzeW5jICgpID0+IHtcbiAgICB2b2lkIGJhY2tncm91bmRSZWZyZXNoLnN0YXJ0KCk7XG5cbiAgICAvLyBSdW4gdGhlIGZpcnN0IHRpbWVyICh3aGljaCBzaG91bGQgdHJpZ2dlciB0aGUgZmlyc3QgcmVmcmVzaClcbiAgICBhd2FpdCBqZXN0LnJ1bk9ubHlQZW5kaW5nVGltZXJzQXN5bmMoKTtcblxuICAgIGV4cGVjdChtb2NrTGlzdFN0YWNrcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIGV4cGVjdChzZXRUaW1lb3V0U3B5KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7IC8vIE9uY2UgZm9yIHN0YXJ0LCBvbmNlIGZvciBuZXh0IHJlZnJlc2hcbiAgICBleHBlY3Qoc2V0VGltZW91dFNweSkudG9IYXZlQmVlbkxhc3RDYWxsZWRXaXRoKGV4cGVjdC5hbnkoRnVuY3Rpb24pLCAzMDAwMDApO1xuXG4gICAgLy8gUnVuIHRoZSBmaXJzdCB0aW1lciAod2hpY2ggdHJpZ2dlcnMgdGhlIGZpcnN0IHJlZnJlc2gpXG4gICAgYXdhaXQgamVzdC5ydW5Pbmx5UGVuZGluZ1RpbWVyc0FzeW5jKCk7XG5cbiAgICBleHBlY3QobW9ja0xpc3RTdGFja3MpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgICBleHBlY3Qoc2V0VGltZW91dFNweSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDMpOyAvLyBUd28gcmVmcmVzaGVzIHBsdXMgb25lIG1vcmUgc2NoZWR1bGVkXG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCB3YWl0IGZvciB0aGUgbmV4dCByZWZyZXNoIGlmIGNhbGxlZCB3aXRoaW4gdGltZSBmcmFtZScsIGFzeW5jICgpID0+IHtcbiAgICB2b2lkIGJhY2tncm91bmRSZWZyZXNoLnN0YXJ0KCk7XG5cbiAgICAvLyBSdW4gdGhlIGZpcnN0IHRpbWVyICh3aGljaCB0cmlnZ2VycyB0aGUgZmlyc3QgcmVmcmVzaClcbiAgICBhd2FpdCBqZXN0LnJ1bk9ubHlQZW5kaW5nVGltZXJzQXN5bmMoKTtcblxuICAgIGNvbnN0IHdhaXRQcm9taXNlID0gYmFja2dyb3VuZFJlZnJlc2gubm9PbGRlclRoYW4oMTgwMDAwKTsgLy8gMyBtaW51dGVzXG4gICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDEyMDAwMCk7IC8vIEFkdmFuY2UgdGltZSBieSAyIG1pbnV0ZXNcblxuICAgIGF3YWl0IGV4cGVjdCh3YWl0UHJvbWlzZSkucmVzb2x2ZXMudG9CZVVuZGVmaW5lZCgpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgd2FpdCBmb3IgdGhlIG5leHQgcmVmcmVzaCBpZiByZWZyZXNoIGxhbmRzIGJlZm9yZSB0aGUgdGltZW91dCcsIGFzeW5jICgpID0+IHtcbiAgICB2b2lkIGJhY2tncm91bmRSZWZyZXNoLnN0YXJ0KCk7XG5cbiAgICAvLyBSdW4gdGhlIGZpcnN0IHRpbWVyICh3aGljaCB0cmlnZ2VycyB0aGUgZmlyc3QgcmVmcmVzaClcbiAgICBhd2FpdCBqZXN0LnJ1bk9ubHlQZW5kaW5nVGltZXJzQXN5bmMoKTtcbiAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMjQwMDApOyAvLyBBZHZhbmNlIHRpbWUgYnkgNCBtaW51dGVzXG5cbiAgICBjb25zdCB3YWl0UHJvbWlzZSA9IGJhY2tncm91bmRSZWZyZXNoLm5vT2xkZXJUaGFuKDMwMDAwMCk7IC8vIDUgbWludXRlc1xuICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSgxMjAwMDApOyAvLyBBZHZhbmNlIHRpbWUgYnkgMiBtaW51dGVzLCByZWZyZXNoIHNob3VsZCBmaXJlXG5cbiAgICBhd2FpdCBleHBlY3Qod2FpdFByb21pc2UpLnJlc29sdmVzLnRvQmVVbmRlZmluZWQoKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIHJlamVjdCBpZiB0aGUgcmVmcmVzaCB0YWtlcyB0b28gbG9uZycsIGFzeW5jICgpID0+IHtcbiAgICB2b2lkIGJhY2tncm91bmRSZWZyZXNoLnN0YXJ0KCk7XG5cbiAgICAvLyBSdW4gdGhlIGZpcnN0IHRpbWVyICh3aGljaCB0cmlnZ2VycyB0aGUgZmlyc3QgcmVmcmVzaClcbiAgICBhd2FpdCBqZXN0LnJ1bk9ubHlQZW5kaW5nVGltZXJzQXN5bmMoKTtcbiAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTIwMDAwKTsgLy8gQWR2YW5jZSB0aW1lIGJ5IDIgbWludXRlc1xuXG4gICAgY29uc3Qgd2FpdFByb21pc2UgPSBiYWNrZ3JvdW5kUmVmcmVzaC5ub09sZGVyVGhhbigwKTsgLy8gMCBzZWNvbmRzXG4gICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDEyMDAwMCk7IC8vIEFkdmFuY2UgdGltZSBieSAyIG1pbnV0ZXNcblxuICAgIGF3YWl0IGV4cGVjdCh3YWl0UHJvbWlzZSkucmVqZWN0cy50b1Rocm93KCdyZWZyZXNoU3RhY2tzIHRvb2sgdG9vIGxvbmc7IHRoZSBiYWNrZ3JvdW5kIHRocmVhZCBsaWtlbHkgdGhyZXcgYW4gZXJyb3InKTtcbiAgfSk7XG59KTtcbiJdfQ==